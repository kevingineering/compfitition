{"ast":null,"code":"import _slicedToArray from \"/home/kevin/Documents/js_html_css/fitness_website/second_start/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/home/kevin/Documents/js_html_css/fitness_website/second_start/client/src/contexts/auth/authState.js\";\nimport React, { useReducer } from 'react';\nimport axios from 'axios';\nimport AuthContext from './authContext';\nimport AuthReducer from './authReducer';\nimport setAuthToken from '../../utils/setAuthToken';\nimport { REGISTER_SUCCESS, REGISTER_FAIL, USER_LOADED, AUTH_ERROR, LOGIN_SUCCESS, LOGIN_FAIL, LOGOUT, UPDATE_SUCCESS, UPDATE_FAIL, PASSWORD_SUCCESS, PASSWORD_FAIL, USER_DELETED_SUCCESS, USER_DELETED_FAIL, SET_AUTH_LOADING, CLEAR_AUTH_ERRORS, GET_SEARCHABLE_USERS, SEARCHABLE_USERS_FAIL } from '../types';\n\nconst AuthState = props => {\n  const initialState = {\n    token: localStorage.getItem('token'),\n    isAuthenticated: false,\n    user: null,\n    searchableUsers: [],\n    error: null,\n    loading: false\n  };\n\n  const _useReducer = useReducer(AuthReducer, initialState),\n        _useReducer2 = _slicedToArray(_useReducer, 2),\n        state = _useReducer2[0],\n        dispatch = _useReducer2[1]; //used for requests sending data\n\n\n  const config = {\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  }; //get user data\n\n  const getUser = async () => {\n    if (localStorage.token) {\n      setAuthToken(localStorage.token);\n    }\n\n    try {\n      setLoading();\n      const res = await axios.get('/api/auth');\n      dispatch({\n        type: USER_LOADED,\n        payload: res.data\n      });\n    } catch (err) {\n      console.log(err);\n      dispatch({\n        type: AUTH_ERROR,\n        payload: err.response.data.msg\n      });\n    }\n  }; //get searchable users\n\n\n  const getSearchableUsers = () => {\n    try {\n      setLoading();\n      dispatch({\n        type: GET_SEARCHABLE_USERS,\n        payload: res.data\n      });\n    } catch (err) {\n      dispatch({\n        type: SEARCHABLE_USERS_FAIL,\n        payload: err.response.data.msg\n      });\n    }\n  }; //log in user\n\n\n  const loginUser = async formData => {\n    try {\n      setLoading();\n      const res = await axios.post('/api/auth', formData, config);\n      dispatch({\n        type: LOGIN_SUCCESS,\n        payload: res.data\n      });\n      getUser();\n      getSearchableUsers();\n    } catch (err) {\n      dispatch({\n        type: LOGIN_FAIL,\n        payload: err.response.data.msg\n      });\n    }\n  }; //register new user\n\n\n  const registerUser = async formData => {\n    try {\n      setLoading();\n      const res = await axios.post('/api/users', formData, config);\n      dispatch({\n        type: REGISTER_SUCCESS,\n        payload: res.data\n      });\n      getUser();\n      getSearchableUsers();\n    } catch (err) {\n      dispatch({\n        type: REGISTER_FAIL,\n        payload: err.response.data.msg\n      });\n    }\n  }; //update user\n\n\n  const updateUser = async user => {\n    try {\n      setLoading();\n      const res = await axios.put(`/api/auth/${user._id}`, user, config);\n      dispatch({\n        type: UPDATE_SUCCESS,\n        payload: {\n          user: res.data.user,\n          msg: res.data.msg\n        }\n      });\n    } catch (err) {\n      dispatch({\n        type: UPDATE_FAIL,\n        payload: err.response.data.msg\n      });\n    }\n  }; //change user password\n\n\n  const changeUserPassword = async (formData, _id) => {\n    try {\n      setLoading();\n      const res = await axios.put(`/api/auth/password/${_id}`, formData, config);\n      dispatch({\n        type: PASSWORD_SUCCESS,\n        payload: res.data.msg\n      });\n    } catch (err) {\n      dispatch({\n        type: PASSWORD_FAIL,\n        payload: err.response.data.msg\n      });\n    }\n  }; //delete user\n\n\n  const deleteUser = async (password, _id) => {\n    try {\n      setLoading();\n      const res = await axios.delete(`/api/auth/${_id}`, {\n        config,\n        data: {\n          password\n        }\n      });\n      dispatch({\n        type: USER_DELETED_SUCCESS,\n        payload: res.data.msg\n      });\n    } catch (err) {\n      dispatch({\n        type: USER_DELETED_FAIL,\n        payload: err.response.data.msg\n      });\n    }\n  }; //logout\n\n\n  const logoutUser = () => {\n    dispatch({\n      type: LOGOUT\n    });\n  }; //set loading\n\n\n  const setLoading = () => {\n    dispatch({\n      type: SET_AUTH_LOADING\n    });\n  }; //clear errors\n\n\n  const clearUserErrors = () => {\n    dispatch({\n      type: CLEAR_AUTH_ERRORS\n    });\n  };\n\n  return React.createElement(AuthContext.Provider, {\n    value: {\n      token: state.token,\n      isAuthenticated: state.isAuthenticated,\n      user: state.user,\n      searchableUsers: state.searchableUsers,\n      error: state.error,\n      loading: state.loading,\n      loginUser,\n      registerUser,\n      updateUser,\n      changeUserPassword,\n      deleteUser,\n      logoutUser,\n      clearUserErrors\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150\n    },\n    __self: this\n  }, props.children);\n};\n\nexport default AuthState;","map":{"version":3,"sources":["/home/kevin/Documents/js_html_css/fitness_website/second_start/client/src/contexts/auth/authState.js"],"names":["React","useReducer","axios","AuthContext","AuthReducer","setAuthToken","REGISTER_SUCCESS","REGISTER_FAIL","USER_LOADED","AUTH_ERROR","LOGIN_SUCCESS","LOGIN_FAIL","LOGOUT","UPDATE_SUCCESS","UPDATE_FAIL","PASSWORD_SUCCESS","PASSWORD_FAIL","USER_DELETED_SUCCESS","USER_DELETED_FAIL","SET_AUTH_LOADING","CLEAR_AUTH_ERRORS","GET_SEARCHABLE_USERS","SEARCHABLE_USERS_FAIL","AuthState","props","initialState","token","localStorage","getItem","isAuthenticated","user","searchableUsers","error","loading","state","dispatch","config","headers","getUser","setLoading","res","get","type","payload","data","err","console","log","response","msg","getSearchableUsers","loginUser","formData","post","registerUser","updateUser","put","_id","changeUserPassword","deleteUser","password","delete","logoutUser","clearUserErrors","children"],"mappings":"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","sourcesContent":["import React, { useReducer } from 'react';\nimport axios from 'axios';\nimport AuthContext from './authContext';\nimport AuthReducer from './authReducer';\nimport setAuthToken from '../../utils/setAuthToken';\nimport {\n  REGISTER_SUCCESS,\n  REGISTER_FAIL,\n  USER_LOADED,\n  AUTH_ERROR,\n  LOGIN_SUCCESS,\n  LOGIN_FAIL,\n  LOGOUT,\n  UPDATE_SUCCESS,\n  UPDATE_FAIL,\n  PASSWORD_SUCCESS,\n  PASSWORD_FAIL,\n  USER_DELETED_SUCCESS,\n  USER_DELETED_FAIL,\n  SET_AUTH_LOADING,\n  CLEAR_AUTH_ERRORS,\n  GET_SEARCHABLE_USERS,\n  SEARCHABLE_USERS_FAIL\n} from '../types';\n\nconst AuthState = props => {\n  const initialState = { \n    token: localStorage.getItem('token'),\n    isAuthenticated: false,\n    user: null,\n    searchableUsers: [],\n    error: null,\n    loading: false\n  };\n\n  const [state, dispatch] = useReducer(AuthReducer, initialState);\n\n  //used for requests sending data\n  const config = { \n    headers: { \n      'Content-Type': 'application/json'\n    }\n  };\n\n  //get user data\n  const getUser = async () => {\n    if (localStorage.token) {\n      setAuthToken(localStorage.token);\n    }\n    try {\n      setLoading();\n      const res = await axios.get('/api/auth');\n      dispatch({ type: USER_LOADED, payload: res.data })\n    } catch (err) {\n      console.log(err);\n      dispatch({ type: AUTH_ERROR, payload: err.response.data.msg });\n    }\n  };\n\n  //get searchable users\n  const getSearchableUsers = () => {\n    try {\n      setLoading();\n      dispatch ({ type: GET_SEARCHABLE_USERS, payload: res.data });\n    } catch (err) {\n      dispatch({ type: SEARCHABLE_USERS_FAIL, payload: err.response.data.msg });\n    }\n  }\n\n  //log in user\n  const loginUser = async formData => {\n    try {\n      setLoading();\n      const res = await axios.post('/api/auth', formData, config);\n      dispatch({ type: LOGIN_SUCCESS, payload: res.data });\n      getUser();\n      getSearchableUsers();\n    } catch (err) {\n      dispatch({ type: LOGIN_FAIL, payload: err.response.data.msg });\n    }\n  };\n\n  //register new user\n  const registerUser = async formData => {\n    try {\n      setLoading();\n      const res = await axios.post('/api/users', formData, config);\n      dispatch({ type: REGISTER_SUCCESS, payload: res.data });\n      getUser();\n      getSearchableUsers();\n    } catch (err) {\n      dispatch({ type: REGISTER_FAIL, payload: err.response.data.msg });\n    }\n  };\n  \n  //update user\n  const updateUser = async user => {\n    try {\n      setLoading();\n      const res = await axios.put(`/api/auth/${user._id}`, user, config);\n      dispatch({ type: UPDATE_SUCCESS, payload: { user: res.data.user, msg: res.data.msg }});\n    } catch (err) {\n      dispatch({ type: UPDATE_FAIL, payload: err.response.data.msg });\n    }\n  };\n\n  //change user password\n  const changeUserPassword = async (formData, _id) => {\n    try { \n      setLoading();\n      const res = await axios.put(`/api/auth/password/${_id}`, formData, config);\n      dispatch({ type: PASSWORD_SUCCESS, payload: res.data.msg });\n    } catch (err) {\n      dispatch({ type: PASSWORD_FAIL, payload: err.response.data.msg });\n    }\n  };\n\n  //delete user\n  const deleteUser = async (password, _id) => {\n    try {\n      setLoading();\n      const res = await axios.delete(`/api/auth/${_id}`, {\n        config,\n        data: {\n          password\n        }\n      });\n      dispatch({ type: USER_DELETED_SUCCESS, payload: res.data.msg });\n    } catch (err) {\n      dispatch({ type: USER_DELETED_FAIL, payload: err.response.data.msg });\n    }\n  };\n\n  //logout\n  const logoutUser = () => {\n    dispatch({ type: LOGOUT });\n  };\n\n  //set loading\n  const setLoading = () => {\n    dispatch({ type: SET_AUTH_LOADING });\n  };\n\n  //clear errors\n  const clearUserErrors = () => {\n    dispatch({ type: CLEAR_AUTH_ERRORS });\n  };\n\n  return (\n    <AuthContext.Provider\n    value={{\n      token: state.token,\n      isAuthenticated: state.isAuthenticated,\n      user: state.user,\n      searchableUsers: state.searchableUsers,\n      error: state.error,\n      loading: state.loading,\n      loginUser,\n      registerUser,\n      updateUser,\n      changeUserPassword,\n      deleteUser,\n      logoutUser,\n      clearUserErrors\n    }}>\n      {props.children}\n    </AuthContext.Provider>\n  )\n}\n\nexport default AuthState;"]},"metadata":{},"sourceType":"module"}