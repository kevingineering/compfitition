{"ast":null,"code":"import _objectSpread from \"/home/kevin/Documents/js_html_css/fitness_website/second_start/client/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"/home/kevin/Documents/js_html_css/fitness_website/second_start/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/home/kevin/Documents/js_html_css/fitness_website/second_start/client/src/components/auth/UserPage.js\";\nimport React, { useContext, useState, useEffect } from 'react';\nimport AuthContext from '../../contexts/auth/authContext';\nimport AlertContext from '../../contexts/alerts/alertContext';\n\nconst UserPage = props => {\n  const authContext = useContext(AuthContext);\n  const user = authContext.user,\n        updateUser = authContext.updateUser,\n        changeUserPassword = authContext.changeUserPassword,\n        deleteUser = authContext.deleteUser,\n        userError = authContext.userError,\n        clearUserErrors = authContext.clearUserErrors;\n  const alertContext = useContext(AlertContext);\n  const setAlert = alertContext.setAlert,\n        clearAlert = alertContext.clearAlert;\n\n  const _useState = useState({\n    firstName: '',\n    lastName: '',\n    alias: '',\n    searchable: true,\n    email: '',\n    oldPassword: '',\n    newPassword: '',\n    newPassword2: ''\n  }),\n        _useState2 = _slicedToArray(_useState, 2),\n        current = _useState2[0],\n        setCurrent = _useState2[1];\n\n  const _useState3 = useState(false),\n        _useState4 = _slicedToArray(_useState3, 2),\n        passwordToggle = _useState4[0],\n        setPasswordToggle = _useState4[1];\n\n  const _useState5 = useState(false),\n        _useState6 = _slicedToArray(_useState5, 2),\n        editToggle = _useState6[0],\n        setEditToggle = _useState6[1];\n\n  const _useState7 = useState(false),\n        _useState8 = _slicedToArray(_useState7, 2),\n        deleteToggle = _useState8[0],\n        setDeleteToggle = _useState8[1];\n\n  const firstName = current.firstName,\n        lastName = current.lastName,\n        alias = current.alias,\n        searchable = current.searchable,\n        email = current.email,\n        oldPassword = current.oldPassword,\n        newPassword = current.newPassword,\n        newPassword2 = current.newPassword2; //populate current with user values\n\n  useEffect(() => {\n    setCurrent(_objectSpread({}, current, {}, user));\n    return () => {\n      clearAlert();\n    }; //eslint-disable-next-line\n  }, [user]); //set alert if error\n\n  useEffect(() => {\n    if (userError === 'User updated!') {\n      setEditToggle(false);\n    } else if (userError === 'Password changed!') {\n      setPasswordToggle(false);\n      setCurrent(_objectSpread({}, current, {\n        oldPassword: '',\n        newPassword: '',\n        newPassword2: ''\n      }));\n    } else if (userError === 'User deleted.') {\n      setDeleteToggle(false);\n    }\n\n    if (userError) {\n      setAlert(userError);\n    } //eslint-disable-next-line\n\n  }, [userError]); //clear errors before redirect\n\n  useEffect(() => {\n    return () => {\n      clearUserErrors();\n    }; //eslint-disable-next-line\n  }, []);\n\n  const handlePassword = async () => {\n    if (newPassword !== newPassword2) setAlert('Passwords do not match.');else {\n      await changeUserPassword({\n        oldPassword,\n        newPassword,\n        newPassword2\n      }, props.match.params.id);\n    }\n  };\n\n  const handleEdit = async () => {\n    if (firstName === '') setAlert('Please enter a first name.');else if (lastName === '') setAlert('Please enter a last name.');else if (email === '') setAlert('Please enter an email.');else {\n      await updateUser(current);\n    }\n  };\n\n  const handleDelete = async () => {\n    if (oldPassword === '') setAlert('Please enter your password.');else {\n      await deleteUser(oldPassword, current._id);\n    }\n  };\n\n  const handleChange = e => {\n    setCurrent(_objectSpread({}, current, {\n      [e.target.name]: e.target.value\n    }));\n  };\n\n  const handleClick = () => {\n    setCurrent(_objectSpread({}, current, {\n      searchable: !searchable\n    }));\n  };\n\n  return React.createElement(\"div\", {\n    className: \"form-container\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100\n    },\n    __self: this\n  }, React.createElement(\"h1\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101\n    },\n    __self: this\n  }, \"User Profile\"), editToggle && React.createElement(\"form\", {\n    autoComplete: \"off\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    htmlFor: \"firstName\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107\n    },\n    __self: this\n  }, \"First Name\"), React.createElement(\"input\", {\n    type: \"text\",\n    value: firstName,\n    name: \"firstName\",\n    onChange: handleChange,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    htmlFor: \"lastName\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117\n    },\n    __self: this\n  }, \"Last Name\"), React.createElement(\"input\", {\n    type: \"text\",\n    value: lastName,\n    name: \"lastName\",\n    onChange: handleChange,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    htmlFor: \"alias\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127\n    },\n    __self: this\n  }, \"Alias (optional - the name your friends will see)\"), React.createElement(\"input\", {\n    type: \"text\",\n    value: alias,\n    name: \"alias\",\n    onChange: handleChange,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    htmlFor: \"email\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137\n    },\n    __self: this\n  }, \"Email Address\"), React.createElement(\"input\", {\n    type: \"email\",\n    value: email,\n    name: \"email\",\n    onChange: handleChange,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    className: \"block\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147\n    },\n    __self: this\n  }, \"Privacy\"), React.createElement(\"label\", {\n    className: \"switch\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148\n    },\n    __self: this\n  }, React.createElement(\"input\", {\n    type: \"checkbox\",\n    checked: searchable,\n    name: \"searchable\",\n    onChange: handleClick,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149\n    },\n    __self: this\n  }), React.createElement(\"span\", {\n    className: \"slider round\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155\n    },\n    __self: this\n  })), React.createElement(\"span\", {\n    className: \"register-span\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157\n    },\n    __self: this\n  }, \"Are other users allowed to search for your name and email? This is how friends will find you.\")), React.createElement(\"input\", {\n    type: \"button\",\n    value: \"Save User\",\n    className: \"btn btn-primary btn-block\",\n    onClick: handleEdit,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160\n    },\n    __self: this\n  })), passwordToggle && React.createElement(\"form\", {\n    autoComplete: \"off\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    htmlFor: \"oldPassword\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173\n    },\n    __self: this\n  }, \"Current Password\"), React.createElement(\"input\", {\n    type: \"password\",\n    value: oldPassword,\n    name: \"oldPassword\",\n    onChange: handleChange,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    htmlFor: \"newPassword\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183\n    },\n    __self: this\n  }, \"New Password\"), React.createElement(\"input\", {\n    type: \"password\",\n    value: newPassword,\n    name: \"newPassword\",\n    onChange: handleChange,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    htmlFor: \"newPassword2\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193\n    },\n    __self: this\n  }, \"Verify New Password\"), React.createElement(\"input\", {\n    type: \"password\",\n    value: newPassword2,\n    name: \"newPassword2\",\n    onChange: handleChange,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194\n    },\n    __self: this\n  })), React.createElement(\"input\", {\n    type: \"button\",\n    value: \"Change Password\",\n    className: \"btn btn-primary btn-block\",\n    onClick: handlePassword,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202\n    },\n    __self: this\n  }), React.createElement(\"input\", {\n    type: \"button\",\n    value: \"Cancel\",\n    className: \"btn btn-primary btn-block\",\n    onClick: () => setPasswordToggle(false),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209\n    },\n    __self: this\n  })), deleteToggle && React.createElement(\"form\", {\n    autoComplete: \"off\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219\n    },\n    __self: this\n  }, React.createElement(\"span\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 220\n    },\n    __self: this\n  }, \"Deleting your account cannot be undone and your information cannot be recovered. Any goals, competitions, or friendships you have will be permanently lost. Are you sure you want to delete your account?\"), React.createElement(\"div\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 221\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    htmlFor: \"oldPassword\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 222\n    },\n    __self: this\n  }, \"Password\"), React.createElement(\"input\", {\n    type: \"password\",\n    value: oldPassword,\n    name: \"oldPassword\",\n    onChange: handleChange,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 223\n    },\n    __self: this\n  })), React.createElement(\"input\", {\n    type: \"button\",\n    value: \"No, keep my account.\",\n    className: \"btn btn-primary btn-block\",\n    onClick: () => setDeleteToggle(false),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 230\n    },\n    __self: this\n  }), React.createElement(\"input\", {\n    type: \"button\",\n    value: \"Yes, delete my account.\",\n    className: \"btn btn-danger btn-block\",\n    onClick: handleDelete,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 236\n    },\n    __self: this\n  })), !editToggle && !passwordToggle && !deleteToggle && React.createElement(React.Fragment, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 246\n    },\n    __self: this\n  }, React.createElement(\"p\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 247\n    },\n    __self: this\n  }, React.createElement(\"strong\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 248\n    },\n    __self: this\n  }, \"Name: \\xA0\\xA0\\xA0\"), firstName, \" \", lastName), React.createElement(\"p\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 251\n    },\n    __self: this\n  }, React.createElement(\"strong\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 252\n    },\n    __self: this\n  }, \"Alias: \\xA0\\xA0\\xA0\\xA0\\xA0\"), alias !== '' ? alias : 'none'), React.createElement(\"p\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 255\n    },\n    __self: this\n  }, React.createElement(\"strong\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 256\n    },\n    __self: this\n  }, \"Email: \\xA0\\xA0\\xA0\\xA0\"), email), React.createElement(\"p\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 259\n    },\n    __self: this\n  }, React.createElement(\"strong\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 260\n    },\n    __self: this\n  }, \"Privacy: \\xA0\"), \"Other users \", searchable ? 'can' : 'cannot', \" search for me using my name and email.\"), React.createElement(\"input\", {\n    type: \"button\",\n    value: \"Edit User\",\n    className: \"btn btn-primary btn-block\",\n    onClick: () => setEditToggle(true),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 263\n    },\n    __self: this\n  }), React.createElement(\"input\", {\n    type: \"button\",\n    value: \"Change Password\",\n    className: \"btn btn-primary btn-block\",\n    onClick: () => setPasswordToggle(true),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 269\n    },\n    __self: this\n  }), React.createElement(\"input\", {\n    type: \"button\",\n    value: \"Delete User\",\n    className: \"btn btn-primary btn-block\",\n    onClick: () => setDeleteToggle(true),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 275\n    },\n    __self: this\n  })));\n};\n\nexport default UserPage;","map":{"version":3,"sources":["/home/kevin/Documents/js_html_css/fitness_website/second_start/client/src/components/auth/UserPage.js"],"names":["React","useContext","useState","useEffect","AuthContext","AlertContext","UserPage","props","authContext","user","updateUser","changeUserPassword","deleteUser","userError","clearUserErrors","alertContext","setAlert","clearAlert","firstName","lastName","alias","searchable","email","oldPassword","newPassword","newPassword2","current","setCurrent","passwordToggle","setPasswordToggle","editToggle","setEditToggle","deleteToggle","setDeleteToggle","handlePassword","match","params","id","handleEdit","handleDelete","_id","handleChange","e","target","name","value","handleClick"],"mappings":"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","sourcesContent":["import React, { useContext, useState, useEffect } from 'react';\nimport AuthContext from '../../contexts/auth/authContext';\nimport AlertContext from '../../contexts/alerts/alertContext';\n\nconst UserPage = props => {\n  const authContext = useContext(AuthContext);\n  const { user, updateUser, changeUserPassword, deleteUser, userError, clearUserErrors } = authContext;\n  \n  const alertContext = useContext(AlertContext);\n  const { setAlert, clearAlert } = alertContext;\n  \n  const [current, setCurrent] = useState({\n    firstName: '',\n    lastName: '',\n    alias: '',\n    searchable: true,\n    email: '',\n    oldPassword: '',\n    newPassword: '',\n    newPassword2: ''\n  });\n  const [passwordToggle, setPasswordToggle] = useState(false);\n  const [editToggle, setEditToggle] = useState(false);\n  const [deleteToggle, setDeleteToggle] = useState(false);\n  \n  const { firstName, lastName, alias, searchable, email, oldPassword, newPassword, newPassword2} = current;\n\n  //populate current with user values\n  useEffect(() => {\n    setCurrent({...current, ...user});\n    return () => {\n      clearAlert();\n    }\n    //eslint-disable-next-line\n  },[user]);\n\n  //set alert if error\n  useEffect(() => {\n    if(userError === 'User updated!') {\n      setEditToggle(false);\n    }\n    else if (userError === 'Password changed!') {\n      setPasswordToggle(false);\n      setCurrent({...current, oldPassword: '', newPassword: '', newPassword2: ''});\n    }\n    else if (userError === 'User deleted.') {\n      setDeleteToggle(false);\n    }\n    if (userError) {\n      setAlert(userError);\n    }\n    //eslint-disable-next-line\n  }, [userError]);\n\n  //clear errors before redirect\n  useEffect(() => {\n    return () => {\n      clearUserErrors();\n    }\n    //eslint-disable-next-line\n  }, []);\n\n  const handlePassword = async () => {\n    if (newPassword !== newPassword2)\n      setAlert('Passwords do not match.');\n    else {\n      await changeUserPassword({oldPassword, newPassword, newPassword2}, props.match.params.id);\n    }\n  };\n\n  const handleEdit = async () => {\n    if (firstName === '') \n      setAlert('Please enter a first name.');\n    else if (lastName === '')\n      setAlert('Please enter a last name.');\n    else if (email === '')\n      setAlert('Please enter an email.');\n    else {\n      await updateUser(current);\n    }\n  };\n\n  const handleDelete = async () => {\n    if (oldPassword === '')\n      setAlert('Please enter your password.');\n    else {\n      await deleteUser(oldPassword, current._id);\n    }\n  }\n\n  const handleChange = e => {\n    setCurrent({...current, [e.target.name]: e.target.value});\n  };\n  \n  const handleClick = () => {\n    setCurrent({ ...current, searchable: !searchable });\n  };\n\n  return (\n    <div className='form-container'>\n      <h1>User Profile</h1>\n      {/*Edit module*/}\n      {editToggle && (\n      <form autoComplete='off'>\n        {/*First Name*/}\n        <div className=\"form-group\">\n          <label htmlFor='firstName'>First Name</label>\n          <input\n            type='text'\n            value={firstName}\n            name='firstName'\n            onChange={handleChange}\n          />\n        </div>\n        {/*Last Name*/}\n        <div className=\"form-group\">\n          <label htmlFor='lastName'>Last Name</label>\n          <input\n            type='text'\n            value={lastName}\n            name='lastName'\n            onChange={handleChange}\n          />\n        </div>\n        {/*Alias*/}\n        <div className=\"form-group\">\n          <label htmlFor='alias'>Alias (optional - the name your friends will see)</label>\n          <input\n            type='text'\n            value={alias}\n            name='alias'\n            onChange={handleChange}\n          />\n        </div>\n        {/*Email Address*/}\n        <div className=\"form-group\">\n          <label htmlFor='email'>Email Address</label>\n          <input\n            type='email'\n            value={email}\n            name='email'\n            onChange={handleChange}\n          />\n        </div>\n        {/*Privacy*/}\n        <div className=\"form-group\">\n          <label className='block'>Privacy</label>\n          <label className='switch'>\n            <input\n              type='checkbox'\n              checked={searchable}\n              name='searchable'\n              onChange={handleClick}\n            />\n            <span className='slider round'/>\n          </label>\n          <span className='register-span'>Are other users allowed to search for your name and email? This is how friends will find you.</span>\n        </div>\n        {/*Save Button*/}\n        <input \n          type='button'\n          value='Save User'\n          className='btn btn-primary btn-block'\n          onClick={handleEdit}\n        />\n      </form>\n      )}\n      {/*Password module*/}\n      {passwordToggle && (\n      <form autoComplete='off'>\n        {/*Old password*/}\n        <div className=\"form-group\">\n          <label htmlFor='oldPassword'>Current Password</label>\n          <input\n            type='password'\n            value={oldPassword}\n            name='oldPassword'\n            onChange={handleChange}\n          />\n        </div>\n        {/*New Password*/}\n        <div className=\"form-group\">\n          <label htmlFor='newPassword'>New Password</label>\n          <input\n            type='password'\n            value={newPassword}\n            name='newPassword'\n            onChange={handleChange}\n          />\n        </div>\n        {/*New Password 2*/}\n        <div className=\"form-group\">\n          <label htmlFor='newPassword2'>Verify New Password</label>\n          <input\n            type='password'\n            value={newPassword2}\n            name='newPassword2'\n            onChange={handleChange}\n          />\n        </div>\n        {/*Save Button*/}\n        <input\n          type='button'\n          value='Change Password'\n          className='btn btn-primary btn-block'\n          onClick={handlePassword}\n        />\n        {/*Cancel Button*/}\n        <input\n          type='button'\n          value='Cancel'\n          className='btn btn-primary btn-block'\n          onClick={() => setPasswordToggle(false)}\n        />\n      </form>\n      )}\n      {/*Delete module*/}\n      {deleteToggle && (\n      <form autoComplete='off'>\n        <span>Deleting your account cannot be undone and your information cannot be recovered. Any goals, competitions, or friendships you have will be permanently lost. Are you sure you want to delete your account?</span>\n        <div className=\"form-group\">\n          <label htmlFor='oldPassword'>Password</label>\n          <input\n            type='password'\n            value={oldPassword}\n            name='oldPassword'\n            onChange={handleChange}\n          />\n        </div>\n        <input\n            type='button'\n            value='No, keep my account.'\n            className='btn btn-primary btn-block'\n            onClick={() => setDeleteToggle(false)}\n          />\n        <input\n            type='button'\n            value='Yes, delete my account.'\n            className='btn btn-danger btn-block'\n            onClick={handleDelete}\n          />\n      </form>\n      )}\n      {/*User Information, Edit, Change Password, and Delete Button*/}\n      {!editToggle && !passwordToggle && !deleteToggle && (\n        <React.Fragment>\n          <p>\n            <strong>Name: &nbsp;&nbsp;&nbsp;</strong>\n            {firstName} {lastName}\n          </p>\n          <p>\n            <strong>Alias: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong>\n            {alias !== '' ? alias : 'none'}\n          </p>\n          <p>\n            <strong>Email: &nbsp;&nbsp;&nbsp;&nbsp;</strong>\n            {email}\n          </p>\n          <p>\n            <strong>Privacy: &nbsp;</strong>\n            Other users {searchable ? 'can' : 'cannot'} search for me using my name and email.\n          </p>\n          <input\n            type='button'\n            value='Edit User'\n            className='btn btn-primary btn-block'\n            onClick={() => setEditToggle(true)}\n          />\n          <input\n            type='button'\n            value='Change Password'\n            className='btn btn-primary btn-block'\n            onClick={() => setPasswordToggle(true)}\n          />\n          <input\n            type='button'\n            value='Delete User'\n            className='btn btn-primary btn-block'\n            onClick={() => setDeleteToggle(true)}\n          />\n        </React.Fragment>\n      )}\n    </div>\n  )\n}\n\nexport default UserPage;"]},"metadata":{},"sourceType":"module"}