{"ast":null,"code":"import _slicedToArray from \"/home/kevin/Documents/js_html_css/fitness_website/second_start/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/home/kevin/Documents/js_html_css/fitness_website/second_start/client/src/contexts/auth/authState.js\";\nimport React, { useReducer } from 'react';\nimport axios from 'axios';\nimport AuthContext from './authContext';\nimport AuthReducer from './authReducer';\nimport { REGISTER_SUCCESS, REGISTER_FAIL, USER_LOADED, AUTH_ERROR, LOGIN_SUCCESS, LOGIN_FAIL, LOGOUT, SET_AUTH_LOADING, CLEAR_AUTH_ERRORS } from '../types';\n\nconst authState = props => {\n  const initialState = {\n    token: localStorage.getItem('token'),\n    isAuthenticated: null,\n    user: null,\n    error: null,\n    loading: false\n  };\n\n  const _useReducer = useReducer(AuthReducer, initialState),\n        _useReducer2 = _slicedToArray(_useReducer, 2),\n        state = _useReducer2[0],\n        dispatch = _useReducer2[1]; //used for register, login, and update\n\n\n  const config = {\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  }; //get user data\n\n  const getUser = async () => {\n    if (localStorage.token) {\n      setAuthToken(localStorage.token);\n    }\n\n    try {\n      setLoading();\n      const res = await axios.get('/api/auth');\n      dispatch({\n        type: USER_LOADED,\n        payload: res.data\n      });\n    } catch (err) {\n      dispatch({\n        type: AUTH_ERROR,\n        payload: err\n      });\n    }\n  }; //log in user\n\n\n  const loginUser = async formData => {\n    try {\n      setLoading();\n      const res = await axios.post('/api/auth', formData, config);\n      dispatch({\n        type: LOGIN_SUCCESS,\n        payload: res.data\n      });\n      getUser();\n    } catch (err) {\n      dispatch({\n        type: LOGIN_FAIL,\n        payload: err\n      });\n    }\n  }; //register new user\n\n\n  const registerUser = async formData => {\n    try {\n      const res = await axios.post('/api/users', formData, config);\n      dispatch({\n        type: REGISTER_SUCCESS,\n        payload: res.data\n      });\n      getUser();\n    } catch (err) {\n      dispatch({\n        type: REGISTER_FAIL,\n        payload: err\n      });\n    }\n  }; //update user\n\n\n  const updateUser = async () => {\n    try {} catch (err) {\n      dispatch({\n        type: AUTH_ERROR,\n        payload: err\n      });\n    }\n  }; //logout\n\n\n  const logoutUser = () => {\n    dispatch({\n      type: LOGOUT\n    });\n  }; //set loading\n\n\n  const setLoading = () => {\n    dispatch({\n      type: SET_AUTH_LOADING\n    });\n  }; //clear erros\n\n\n  const clearErrors = () => {\n    dispatch({\n      type: CLEAR_AUTH_ERRORS\n    });\n  };\n\n  return React.createElement(AuthContext.Provider, {\n    value: {\n      user: state.user,\n      error: state.error,\n      loading: state.loading,\n      getUser,\n      loginUser,\n      registerUser,\n      updateUser,\n      logoutUser,\n      clearErrors\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97\n    },\n    __self: this\n  }, props.children);\n};\n\nexport default authState;","map":{"version":3,"sources":["/home/kevin/Documents/js_html_css/fitness_website/second_start/client/src/contexts/auth/authState.js"],"names":["React","useReducer","axios","AuthContext","AuthReducer","REGISTER_SUCCESS","REGISTER_FAIL","USER_LOADED","AUTH_ERROR","LOGIN_SUCCESS","LOGIN_FAIL","LOGOUT","SET_AUTH_LOADING","CLEAR_AUTH_ERRORS","authState","props","initialState","token","localStorage","getItem","isAuthenticated","user","error","loading","state","dispatch","config","headers","getUser","setAuthToken","setLoading","res","get","type","payload","data","err","loginUser","formData","post","registerUser","updateUser","logoutUser","clearErrors","children"],"mappings":"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","sourcesContent":["import React, { useReducer } from 'react';\nimport axios from 'axios';\nimport AuthContext from './authContext';\nimport AuthReducer from './authReducer';\nimport {\n  REGISTER_SUCCESS,\n  REGISTER_FAIL,\n  USER_LOADED,\n  AUTH_ERROR,\n  LOGIN_SUCCESS,\n  LOGIN_FAIL,\n  LOGOUT,\n  SET_AUTH_LOADING,\n  CLEAR_AUTH_ERRORS\n} from '../types';\n\nconst authState = props => {\n  const initialState = { \n    token: localStorage.getItem('token'),\n    isAuthenticated: null,\n    user: null,\n    error: null,\n    loading: false\n  };\n\n  const [state, dispatch] = useReducer(AuthReducer, initialState);\n\n  //used for register, login, and update\n  const config = { \n    headers: { \n      'Content-Type': 'application/json'\n    }\n  };\n\n  //get user data\n  const getUser = async () => {\n    if (localStorage.token) {\n      setAuthToken(localStorage.token);\n    }\n    try {\n      setLoading();\n      const res = await axios.get('/api/auth');\n      dispatch({ type: USER_LOADED, payload: res.data })\n    } catch (err) {\n      dispatch({ type: AUTH_ERROR, payload: err });\n    }\n  }\n\n  //log in user\n  const loginUser = async formData => {\n    try {\n      setLoading();\n      const res = await axios.post('/api/auth', formData, config);\n      dispatch({ type: LOGIN_SUCCESS, payload: res.data });\n      getUser();\n    } catch (err) {\n      dispatch({ type: LOGIN_FAIL, payload: err });\n    }\n  }\n\n  //register new user\n  const registerUser = async formData => {\n    try {\n      const res = await axios.post('/api/users', formData, config);\n      dispatch({ type: REGISTER_SUCCESS, payload: res.data });\n      getUser();\n    } catch (err) {\n      dispatch({ type: REGISTER_FAIL, payload: err });\n    }\n  }\n  \n  //update user\n  const updateUser = async () => {\n    try {\n\n    } catch (err) {\n      dispatch({ type: AUTH_ERROR, payload: err });\n    }\n  }\n\n  //logout\n  const logoutUser = () => {\n    dispatch({ type: LOGOUT });\n  };\n\n  //set loading\n  const setLoading = () => {\n    dispatch({ type: SET_AUTH_LOADING });\n  };\n\n  //clear erros\n  const clearErrors = () => {\n    dispatch({ type: CLEAR_AUTH_ERRORS });\n  };\n\n  return (\n    <AuthContext.Provider\n    value={{\n      user: state.user,\n      error: state.error,\n      loading: state.loading,\n      getUser,\n      loginUser,\n      registerUser,\n      updateUser,\n      logoutUser,\n      clearErrors\n    }}>\n      {props.children}\n    </AuthContext.Provider>\n  )\n}\n\nexport default authState;"]},"metadata":{},"sourceType":"module"}