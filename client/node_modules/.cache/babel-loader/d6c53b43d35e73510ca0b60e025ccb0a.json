{"ast":null,"code":"import _slicedToArray from \"/home/kevin/Documents/js_html_css/fitness_website/second_start/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/home/kevin/Documents/js_html_css/fitness_website/second_start/client/src/components/goals/GoalPassFail.js\";\nimport React, { useState, useContext, useEffect } from 'react';\nimport moment from 'moment';\nimport AlertContext from '../../contexts/alerts/alertContext';\nimport { round } from 'mathjs';\nimport PropTypes from 'prop-types';\nimport GoalInfo from './goalPieces/GoalInfo';\n\nconst GoalPassFail = ({\n  isOwner,\n  goal,\n  time,\n  isStarted\n}) => {\n  const alertContext = useContext(AlertContext);\n  const setAlert = alertContext.setAlert,\n        clearAlert = alertContext.clearAlert;\n  const duration = goal.duration,\n        startDate = goal.startDate,\n        units = goal.units,\n        total = goal.total,\n        compId = goal.compId,\n        tracker = goal.tracker,\n        type = goal.type;\n\n  const _useState = useState(tracker),\n        _useState2 = _slicedToArray(_useState, 2),\n        record = _useState2[0],\n        setRecord = _useState2[1];\n\n  let isComplete = false;\n\n  if (time = duration) {\n    isComplete = true;\n  }\n\n  const handleSave = async record => {\n    await updateGoalTracker(record, _id);\n\n    if (goalsError) {\n      setAlert(goalsError);\n    } else {\n      setAlert('Goal saved!');\n    }\n  };\n\n  useEffect(() => {\n    setRecord(record.map((value, index) => {\n      if (index < time && value === null) {\n        value = false;\n      }\n\n      return value;\n    })); //eslint-disable-next-line\n  }, []); //clear alert before redirect\n\n  useEffect(() => {\n    return () => {\n      clearAlert();\n    }; //eslint-disable-next-line\n  }, []);\n  let value = 0;\n\n  for (let i = 0; i < record.length; i++) {\n    if (record[i] === true) value++;\n  }\n\n  let toDatePercentage = round(value / (time + 1) * 100);\n  let totalPercentage = round(value / record.length * 100); //event.target will get the icon and fail, but event.currentTarget will get the button every time\n\n  const handleClick = e => {\n    if (isComplete || !isOwner) {\n      return null;\n    }\n\n    let clickLoc = parseInt(e.currentTarget.name);\n\n    if (isStarted || time < clickLoc) {\n      setAlert(\"You can't record the future.\");\n    } else if (time === clickLoc || time === clickLoc + 1) {\n      setRecord(record.map((value, index) => {\n        if (index === clickLoc) {\n          if (value === null || value === false) {\n            value = true;\n          } else value = false;\n        }\n\n        return value;\n      }));\n    } else {\n      setAlert(\"You can only record data for today and yesterday.\");\n    }\n  };\n\n  const table = () => {\n    let list = [];\n\n    for (let i = 0; i < duration / 7; i++) {\n      list.push(React.createElement(\"span\", {\n        className: \"table-row\",\n        key: i,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 88\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        className: \"table-label\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89\n        },\n        __self: this\n      }, \"Week \", i + 1, React.createElement(\"span\", {\n        className: \"hide-sm\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 90\n        },\n        __self: this\n      }, '', \" - \", moment.utc(startDate).add(7 * i, 'day').format('MMM Do'))), React.createElement(\"span\", {\n        className: \"table-buttons\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 94\n        },\n        __self: this\n      }, buttons(i))));\n    }\n\n    return list;\n  };\n\n  const buttons = week => {\n    let list = [];\n\n    for (let i = 0; i < total; i++) {\n      let loc = week * total + i;\n      list.push(React.createElement(\"button\", {\n        className: `table-btn ${time === loc && 'table-btn-today'}`,\n        onClick: handleClick,\n        key: loc,\n        name: loc,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 107\n        },\n        __self: this\n      }, record[loc] && React.createElement(\"i\", {\n        className: \"fas fa-check success-color\",\n        name: loc,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 113\n        },\n        __self: this\n      }), !record[loc] && record[loc] !== null && React.createElement(\"i\", {\n        className: \"fas fa-times danger-color\",\n        name: loc,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 114\n        },\n        __self: this\n      }), record[loc] === null && ' '));\n    }\n\n    return list;\n  };\n\n  return React.createElement(React.Fragment, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123\n    },\n    __self: this\n  }, React.createElement(\"ul\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124\n    },\n    __self: this\n  }, React.createElement(\"li\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126\n    },\n    __self: this\n  }, table()), React.createElement(GoalInfo, {\n    goal: goal,\n    record: record,\n    time: time,\n    value: value,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130\n    },\n    __self: this\n  })), !isComplete && isOwner && React.createElement(React.Fragment, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139\n    },\n    __self: this\n  }, React.createElement(\"button\", {\n    className: \"btn btn-primary btn-block\",\n    onClick: () => handleSave(record),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140\n    },\n    __self: this\n  }, \"Save Goal\"), React.createElement(\"p\", {\n    className: \"lr-border\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143\n    },\n    __self: this\n  })), React.createElement(GoalButtons, {\n    isActive: time <= duration,\n    handleSave: handleSave,\n    isOwner: isOwner,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146\n    },\n    __self: this\n  }));\n};\n\nGoalPassFail.propTypes = {\n  handleSave: PropTypes.func,\n  goal: PropTypes.object.isRequired,\n  isOwner: PropTypes.bool.isRequired\n};\nexport default GoalPassFail;","map":{"version":3,"sources":["/home/kevin/Documents/js_html_css/fitness_website/second_start/client/src/components/goals/GoalPassFail.js"],"names":["React","useState","useContext","useEffect","moment","AlertContext","round","PropTypes","GoalInfo","GoalPassFail","isOwner","goal","time","isStarted","alertContext","setAlert","clearAlert","duration","startDate","units","total","compId","tracker","type","record","setRecord","isComplete","handleSave","updateGoalTracker","_id","goalsError","map","value","index","i","length","toDatePercentage","totalPercentage","handleClick","e","clickLoc","parseInt","currentTarget","name","table","list","push","utc","add","format","buttons","week","loc","propTypes","func","object","isRequired","bool"],"mappings":"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","sourcesContent":["import React, { useState, useContext, useEffect } from 'react';\nimport moment from 'moment';\nimport AlertContext from '../../contexts/alerts/alertContext';\nimport { round } from 'mathjs';\nimport PropTypes from 'prop-types';\nimport GoalInfo from './goalPieces/GoalInfo';\n\nconst GoalPassFail = ({isOwner, goal, time, isStarted}) => {\n  const alertContext = useContext(AlertContext);\n  const {setAlert, clearAlert} = alertContext;\n\n  const { duration, startDate, units, total, compId, tracker, type } = goal;\n\n  const [record, setRecord] = useState(tracker);\n\n  let isComplete = false;\n  if (time = duration) {\n    isComplete = true;\n  }\n\n  const handleSave = async (record) => {\n    await updateGoalTracker(record, _id);\n    if (goalsError) {\n      setAlert(goalsError);\n    }\n    else {\n      setAlert('Goal saved!');\n    }\n  }\n\n  useEffect(() => {\n    setRecord(record.map((value, index) => {\n      if (index < time && value === null) {\n        value = false;\n      }\n      return value;\n    }));\n    //eslint-disable-next-line\n  }, []);\n\n  //clear alert before redirect\n  useEffect(() => {\n    return () => {\n      clearAlert();\n    }\n    //eslint-disable-next-line\n  }, []);\n\n  let value = 0;\n\n  for (let i = 0; i < record.length; i++ ) {\n    if (record[i] === true) \n      value++;\n  }\n\n  let toDatePercentage = round(value / (time + 1) * 100);\n  let totalPercentage = round(value / record.length * 100);\n\n  //event.target will get the icon and fail, but event.currentTarget will get the button every time\n  const handleClick = e => {\n    if (isComplete || !isOwner) {\n      return null;\n    }\n    let clickLoc = parseInt(e.currentTarget.name);\n    if (isStarted || time < clickLoc) {\n      setAlert(\"You can't record the future.\");\n    }\n    else if (time === clickLoc || time === clickLoc + 1) {\n      setRecord(record.map((value, index) => {\n        if (index === clickLoc) {\n          if (value === null || value === false) {\n            value = true;\n          }\n          else value = false;\n        }\n        return value;\n      }))\n    }\n    else {\n      setAlert(\"You can only record data for today and yesterday.\");\n    }\n  };\n\n  const table = () => {\n    let list = [];\n    for(let i = 0; i < duration / 7; i++) {\n      list.push(\n        <span className='table-row' key={i}>\n          <span className='table-label'>Week {i + 1}\n            <span className='hide-sm'>\n              {''} - {moment.utc(startDate).add(7 * i, 'day').format('MMM Do')}\n            </span>\n          </span>\n          <span className='table-buttons'>\n            {buttons(i)}\n          </span>\n        </span>);\n    }\n    return list;\n  };\n\n  const buttons = week => {\n    let list = [];\n    for(let i = 0; i < total; i++) {\n      let loc = week * total + i;\n      list.push(\n        <button \n          className={`table-btn ${time === loc && 'table-btn-today'}`}\n          onClick={handleClick} \n          key={loc} \n          name={loc} \n        >\n          {record[loc] && <i className='fas fa-check success-color' name={loc}/>}\n          {!record[loc] && record[loc] !== null && <i className='fas fa-times danger-color' name={loc}/>}\n          {record[loc] === null && ' '}\n        </button>\n      )\n    }\n    return list;\n  };\n\n  return (\n    <React.Fragment>\n      <ul>\n        {/* Chart */}\n        <li>\n          {table()}\n        </li>\n        {/* Info */}\n        <GoalInfo \n          goal={goal}\n          record={record}\n          time={time}\n          value={value}\n        />\n      </ul>\n      {/* Start Button */}\n      {!isComplete && isOwner && \n        <React.Fragment>\n          <button className='btn btn-primary btn-block' onClick={() => handleSave(record)}>\n            Save Goal\n          </button>\n          <p className='lr-border'/>\n        </React.Fragment>\n      }\n      <GoalButtons \n        isActive={time <= duration} \n        handleSave={handleSave}\n        isOwner={isOwner}\n      />\n    </React.Fragment>\n  );\n};\n\nGoalPassFail.propTypes = {\n  handleSave: PropTypes.func,\n  goal: PropTypes.object.isRequired,\n  isOwner: PropTypes.bool.isRequired\n}\n\nexport default GoalPassFail;"]},"metadata":{},"sourceType":"module"}